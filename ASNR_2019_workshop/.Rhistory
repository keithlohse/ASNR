position=position_jitter(w=0.2, h=0))+
geom_boxplot(fill="white", col="black", outlier.shape = "na",
alpha=0.4, width=0.5)+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none")
# Boxplots
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2,
position=position_jitter(w=0.2, h=0))+
geom_boxplot(fill="white", col="black", outlier.shape = "na",
alpha=0.4, width=0.5)+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none")
# Connect the dots
head(DAT2)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="blue", lwd=2, se=FALSE)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(aes(fill=Elevation), stat="mean", pch=21, size=2)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(aes(fill=Elevation), stat="average", pch=21, size=2)
# Connect the dots
head(DAT2)
DAT3 <- DAT2 %>%
group_by(Elevation, Speed) %>%
summarise(Effort_AVE=mean(Effort))
head(DAT3)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(DAT3, aes(fill=Elevation), pch=21, size=2)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, aes(fill=Elevation), pch=21, size=2)
DAT3 <- DAT2 %>%
group_by(Elevation, Speed) %>%
summarise(Effort=mean(Effort))
head(DAT3)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, pch=21, size=2)
DAT3 <- DAT2 %>%
group_by(Elevation, Speed) %>%
summarise(Effort=mean(Effort))
head(DAT3)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, aes(fill=Elevation), pch=21, size=2)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, fill="back", pch=21, size=3)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, aes(group=Elevation), fill="back", pch=21, size=3)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, aes(fill=Elevation), pch=21, size=3)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, aes(col=Elevation), pch=21, size=3)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, aes(col=Elevation), fill="black" pch=21, size=4)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, aes(col=Elevation), fill="black", pch=21, size=4)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, aes(col=Elevation), fill="black", pch=6, size=4)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, aes(col=Elevation), fill="black", shape=6, size=4)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, aes(col=Elevation), fill="black", shape=15, size=4)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, aes(col=Elevation), fill="black", shape=22, size=4)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, fill="black", shape=22, size=4)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, aes(fill=Elevation), fill="black", shape=22, size=4)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, aes(fill=Elevation), shape=22, size=4)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, fill="black", shape=21, size=4)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ))+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, fill="black", shape=21, size=5)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ), col="grey80")+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, fill="black", shape=21, size=5)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ), col="grey20")+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, fill="black", shape=21, size=5)
ggplot(DAT2, aes(x = Elevation, y = Effort)) +
geom_point(aes(fill=Elevation), pch=21, size=2)+
#geom_boxplot(fill="white", col="black", outlier.shape = "na",
#             alpha=0.4, width=0.5)+
geom_line(aes(group=SUBJ), col="grey40")+
facet_wrap(~Speed) +
scale_y_continuous(name = "Effort (%)", limits = c(0,100)) +
theme(axis.text=element_text(size=16, color="black"),
axis.title=element_text(size=16, face="bold"),
plot.title=element_text(size=16, face="bold", hjust=0.5),
panel.grid.minor = element_blank(),
strip.text = element_text(size=16, face="bold"),
legend.position = "none") +
stat_smooth(aes(group=Speed, lty=Speed), col="black", lwd=2, se=FALSE)+
geom_point(data=DAT3, fill="black", shape=21, size=5)
# Loading the essential libraries.
library("ggplot2"); library("lme4"); library("car");
library("dplyr"); library("tidyr"); library("lmerTest")
setwd("C:/Users/kelop/Box Sync/Collaboration/Linda Van Dillen")
list.files("./")
DATA<-read.csv("./lohse_clinic_data20190522.csv", header = TRUE, sep=",",
na.strings=c("NA","NaN"," ",""))
COV<-read.csv("./lohse_covariates.csv", header = TRUE, sep=",",
na.strings=c("NA","NaN"," ",""))
DATA<-merge(DATA, COV, by=c("v_ID"), all=TRUE)
head(DATA)
# Removing Participants who never received treatment
summary(as.factor(DATA$Group))
DATA<-subset(DATA, Group != "NA")
# Re-coding v_ID and base_SCLV1_Treatment as factors
DATA$v_ID<-factor(DATA$v_ID)
summary(DATA$v_ID)
xtabs(~v_ID+Phase,data=DATA)
# Re-coding Treatment and Booster Variables for Proper Coding:
DATA$MST<-DATA$Treatment
contrasts(DATA$MST)
contrasts(DATA$MST)<-contr.treatment(2, base=2)
contrasts(DATA$MST)
contrasts(DATA$Booster)
contrasts(DATA$Booster)<-contr.treatment(2, base=2)
contrasts(DATA$Booster)
# Mean Centering MODI and Pain symptoms
DATA_AVE <- DATA %>%
group_by(v_ID) %>%
summarise(baseModi = mean(base_sasMODIscore, na.rm=TRUE),
basePainAve = mean(base_NRS_AverageSymptoms, na.rm=TRUE))
head(DATA_AVE)
DATA_AVE$baseModi.c<-DATA_AVE$baseModi-mean(DATA_AVE$baseModi, na.rm=TRUE)
DATA_AVE$basePainAve.c<-DATA_AVE$basePainAve-mean(DATA_AVE$basePainAve, na.rm=TRUE)
DATA<-merge(DATA, DATA_AVE, by=c("v_ID"), all=TRUE)
head(DATA)
# Mean time of departure from DATA
mean(DATA$days_from_baseline[DATA$RedcapEvent=="10"], na.rm=TRUE)
## MODI Models spanning all time points ----------------------------------------
# Linear Model of Time by Phase ----
head(DATA)
DATA$phase_centered_month<-DATA$phase_centered_day/30
m0<-lmer(sasMODIscore ~
# Fixed-effects
1+phase_centered_month*Phase*MST*Booster+
baseModi.c+
Female.c+Age.c+Duration.c+
# Random-effects
(1|v_ID)+(1+phase_centered_month|v_ID:Phase), data=DATA, REML=FALSE)
Anova(m0, type="III")
summary(m0)
# Regression Assumptions
plot(density(resid(m0)))
qqnorm(resid(m0)/sd(resid(m0)), ylim=c(-5,5), xlim=c(-5,5))
abline(a=0, b=1)
RE_int<-ranef(m0)$`v_ID:Phase`$`(Intercept)`
RE_slope<-ranef(m0)$`v_ID:Phase`$phase_centered_month
RE_int_sub<-ranef(m0)$v_ID$`(Intercept)`
qqnorm(RE_int/sd(RE_int))
abline(a=0, b=1)
qqnorm(RE_slope/sd(RE_slope))
abline(a=0, b=1)
qqnorm(RE_int_sub/sd(RE_int_sub))
abline(a=0, b=1)
# Phase by Time Plot
g1<-ggplot(DATA, aes(x = days_from_baseline/30, y = sasMODIscore)) +
annotate("rect", xmin=0, xmax=(92.67/30), ymin=0, ymax=Inf, alpha=0.6, fill="grey")+
geom_line(aes(group=v_ID, col=Phase), alpha=0.4)+
#geom_point(aes(fill=as.factor(v_ID)), pch=21, size=2, stroke=1.25) +
stat_smooth(aes(group=Phase, lty=MST, col=Phase), method="lm", se=FALSE, lwd=1.5)+
facet_wrap(~Group)
g2<-g1+scale_x_continuous(name = "Time (Months Since Baseline Assessment)") +
scale_y_continuous(name = "Modified Oswestry Disability Index")
g3 <- g2 + theme_bw() +
theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(strip.text.x = element_text(size = 14)) +
theme(legend.position="none")
print(g3)
# By treating this workshop as an R project, we can use relative file paths that
# allow you to open the data anywhere on any computer, provided you have downloaded
# the whole workshop folder.
getwd()
